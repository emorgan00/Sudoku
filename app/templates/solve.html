{% extends 'base.html' %}
{% block content %}

	<form class='sudoku_form' id='sudoku_form' method='POST' onkeypress='return event.keyCode != 13;'>
		<div style='width: 50%; float: left'>
			<p class='choice_header'>Variant</p>
			<div class='choice_box'>
				{% for v in variants %}
				<input type='radio' name='variant' value='{{ v.code }}' required {% if v.code.upper() == 'KNIGHT' %}checked{% endif %}> {{ v.name }} <br>
				{% endfor %}
			</div>
			<p class='choice_header'>Import Code</p>
			<div class='choice_box'>
				<input type='button' value='Import Code...' onclick='import_code();'>
				<input type='text' id='code' placeholder='Enter Code' autocomplete='new-password'>
			</div>
		</div>
		<div style='width: 50%; min-width: 540px; float: left'>
			<div style='width: 540px; float: center'>
				<p class='choice_header'>Edit Grid:</p>
				{{ puzzle|safe }}
				<input id='solve_button' type='submit' name='submit_type' value='Solve' style='margin-top: 50px; float: left;' onclick='loading();'>
				<input id='solve_button' type='submit' name='submit_type' value='Score (Without Solving)' style='margin-top: 50px; float: left; margin-left: 15px;' onclick='loading();'>
			</div>
		</div>
	</form>

	<script type='text/javascript'>

		function loading() {
			document.getElementById("content").style.opacity = "0.5";
			document.getElementsByTagName("BODY")[0].style.cursor = "wait";
			document.getElementById("solve_button").style.cursor = "wait";
		}

		function import_code() {
			var form = document.getElementById("sudoku_form");
			var code_input = form.elements['code'];
			var code = code_input.value;
			code_input.value = '';

			code = code.replace(/\s/g,'').replace(/\n/g,'').replace(/\t/g,'');

			for (i = 0; i < code.length; i++) {
				var ch = code.charAt(i);
				var x = i%9;
				var y = Math.floor(i/9);
				if (ch != '' && '123456789'.indexOf(ch) !== -1) {
					form.elements[`tile_${y}${x}`].value = ch;
				} else {
					form.elements[`tile_${y}${x}`].value = '';
				}
			}
		}

	</script>

{% endblock %}